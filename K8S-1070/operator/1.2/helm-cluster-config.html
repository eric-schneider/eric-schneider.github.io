<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Helm Cluster Configuration | Couchbase Docs</title>
    <link rel="canonical" href="eric-schneider.github.io/K8S-1070/operator/1.2/helm-cluster-config.html">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script>(window.dataLayer=window.dataLayer||[]).push({'gtm.start':+new Date(),event:'gtm.js'})</script>
    <script async src="https://www.googletagmanager.com/gtm.js?id=GTM-MVPNN2"></script>
    <link rel="schema.dcterms" href="https://purl.org/dc/terms/">
    <meta name="dcterms.subject" content="operator">
    <meta name="dcterms.identifier" content="1.2">
    <meta name="generator" content="Antora 2.0.0">
    <link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar" id="topbar">
    <div class="container">
      <div class="navbar-brand">
        <a class="navbar-item" href="https://www.couchbase.com"><img src="../../_/img/logo.svg" alt="Couchbase"></a>
        <button class="navbar-burger" data-target="topbar-menu">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
      <div id="topbar-menu" class="navbar-menu">
        <div class="navbar-start">
          <div class="navbar-item has-dropdown">
            <a class="navbar-link" href="eric-schneider.github.io/K8S-1070">Docs</a>
            <div class="navbar-dropdown explore">
              <div class="title">Couchbase Documentation Overview</div>
              <div class="cols">
                <ul>
                  <li class="heading"><a href="../../server/6.0/introduction/intro.html">Server</a></li>
                  <li><a href="../../server/6.0/n1ql/n1ql-language-reference/index.html">N1QL</a></li>
                  <li><a href="../../server/6.0/fts/full-text-intro.html">Full Text Search</a></li>
                  <li><a href="../../server/6.0/analytics/introduction.html">Analytics</a></li>
                  <li><a href="../../server/6.0/eventing/eventing-overview.html">Eventing</a></li>
                  <li><a href="overview.html">Autonomous Operator</a></li>
                </ul>
                <ul>
                  <li class="heading">Mobile</li>
                  <li><a href="#">Lite</a></li>
                  <li><a href="#">Sync Gateway</a></li>
                </ul>
                <ul class="two-cols">
                  <li class="heading"><a href="../../server/6.0/sdk/overview.html">SDKs</a></li>
                  <li><a href="#">C</a></li>
                  <li><a href="#">.NET</a></li>
                  <li><a href="#">Go</a></li>
                  <li><a href="#">Java</a></li>
                  <li><a href="#">Node.js</a></li>
                  <li><a href="#">PHP</a></li>
                  <li><a href="#">Python</a></li>
                  <li><a href="#">Scala</a></li>
                </ul>
                <ul>
                  <li class="heading"><a href="../../server/6.0/connectors/intro.html">Connectors</a></li>
                  <li><a href="#">Elasticsearch</a></li>
                  <li><a href="../../server/6.0/connectors/hadoop-1.2/hadoop.html">Hadoop</a></li>
                  <li><a href="#">Kafka</a></li>
                  <li><a href="#">Spark</a></li>
                  <li><a href="#">Talend</a></li>
                  <li><a href="../../server/6.0/connectors/odbc-jdbc-drivers.html">ODBC/JDBC</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="navbar-item has-dropdown">
            <a class="navbar-link component" href="overview.html"><span class="title">Autonomous Operator</span> <span class="version">1.2</span></a>
            <div class="navbar-dropdown versions">
              <div class="cols">
                <ul>
                  <li><a class="navbar-item" href="../1.1/overview.html">Autonomous Operator 1.1</a></li>
                  <li><a class="navbar-item" href="../1.0/overview.html">Autonomous Operator 1.0</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="navbar-end">
          <div class="navbar-item">
            <a class="btn red-btn" href="https://www.couchbase.com/downloads">Downloads</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body container">
<nav class="nav">
<div class="nav-menu">
<ul class="nav-list">
  <li class="nav-item is-active" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="overview.html">Introduction</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="whats-new.html">What&#8217;s New?</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <span class="nav-text">Getting Started</span>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="prerequisite-and-setup.html">System Requirements</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="network-requirements.html">Network Requirements</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="best-practices.html">Guidelines and Best Practices</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="cloud-intro.html">Cloud Environment Setup</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="install-aks.html">Installing on AKS</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="install-eks.html">Installing on EKS</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="install-gke.html">Installing on GKE</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-path is-active" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <span class="nav-text">Helm</span>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="helm-setup-guide.html">Helm Setup</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="helm-managing-guide.html">Helm Management</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="helm-operator-config.html">Operator Chart Spec</a>
    </span>
  </li>
  <li class="nav-item is-current-page is-active" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="helm-cluster-config.html">Couchbase Cluster Chart Spec</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <span class="nav-text">Deploying the Operator</span>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="install-admission-controller.html">Installing the Admission Controller</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="install-kubernetes.html">Installing on Kubernetes</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="install-openshift.html">Installing on OpenShift</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="operator-config.html">About the Operator Deployment Settings</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="kubernetes-rbac.html">About Kubernetes RBAC</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="upgrading-the-operator.html">Upgrading the Operator</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <span class="nav-text">Managing the Operator</span>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="list-and-describe.html">Monitoring Kubernetes Resources</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="services.html">Monitoring Services</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="deploying-couchbase.html">Deploying Couchbase Server</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="couchbase-cluster-config.html">Couchbase Configuration Settings</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="networking.html">About Kubernetes Networking</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <span class="nav-line">
    <a class="nav-link" href="xdcr.html">Using XDCR</a>
    </span>
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-line">
    <a class="nav-link" href="tls.html">Configuring TLS</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="accessing-couchbase.html">Accessing the Couchbase User Interfaces</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="persistent-volumes-guide.html">Persistent Volumes</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <span class="nav-line">
    <a class="nav-link" href="persistent-volumes-setup.html">Persistent Volume Kubernetes Guide</a>
    </span>
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-line">
    <a class="nav-link" href="persistent-volumes-zoning-guide-legacy.html">Persistent Volume Kubernetes Guide (Legacy)</a>
    </span>
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-line">
    <a class="nav-link" href="persistent-volumes-zoning-guide.html">Persistent Volume Zoning Guide</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="server-groups.html">Using Server Groups</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="couchbase-clients.html">Using Couchbase Clients</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="running-couchbase.html">Managing Couchbase Server</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="updating-couchbase.html">Modifying a Couchbase Deployment</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="scaling-couchbase.html">Scaling a Couchbase Deployment</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="node-recovery.html">Recovering From a Node Failure</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="delete-couchbase-cluster.html">Deleting a Couchbase Deployment</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="upgrading-couchbase.html">Upgrading a Couchbase Deployment</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="upgrading-kubernetes.html">Upgrading the Kubernetes Cluster</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="backup-and-restore.html">Backing up and Restoring a Couchbase Deployment</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="conditions-and-events.html">Monitoring Couchbase Events</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="cluster-status-guide.html">Monitoring Couchbase Cluster Status</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <span class="nav-text">Troubleshooting</span>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="logs-troubleshooting.html">Viewing and Retrieving Logs</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <span class="nav-text">Tools</span>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="cbopinfo.html">cbopinfo</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="demo.html">Couchbase Deployment Tutorial</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="release-notes.html">Release Notes</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item is-active" data-depth="0">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <span class="nav-text">Other Resources</span>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="#">sync-gateway::kubernetes/deploy-cluster.adoc</a>
    </span>
  </li>
</ul>
  </li>
</ul>
</div>
</nav>
<aside class="toc sidebar">
  <div class="toc-menu"></div>
</aside>
<main class="article" data-ceiling="topbar">
  <div class="article-header">
<button class="nav-control"></button>
<nav class="crumbs" aria-label="breadcrumbs">
  <ul>
    <li class="crumb"><a href="overview.html">Autonomous Operator</a></li>
    <li class="crumb">Helm</li>
    <li class="crumb"><a href="helm-cluster-config.html">Couchbase Cluster Chart Spec</a></li>
  </ul>
</nav>
<div class="tools" role="navigation">
  <ul>
    <li class="tool edit"><a href="file:///Users/ericschneider/repos/couchbase-operator/docs/user/modules/ROOT/pages/helm-cluster-config.adoc" title="Edit Page" target="_blank" rel="noopener">Edit</a></li>
  </ul>
</div>
  </div>
<article class="doc">
<h1 class="page">Helm Cluster Configuration</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This guide outlines the design and usage of the helm chart for deploying a couchbase cluster.
This chart is especially helpful for rolling out development clusters and generating TLS certificates and keys.
Howerver, configurations requiring server groups and persistent volumes are better expressed and managed directly using a cluster spec.
Refer to the couchbase operator documentation regarding <a href="https://docs.couchbase.com/operator/1.1/deploying-couchbase.html">deploying couchbase</a> directly from kubectl.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The cluster chart requires the custom resource definition (CRD) to be installed so that Kubernetes knows about the CouchbaseCluster type.
By default the Operator will install the CRD for you. But if you’ve disabled this function, then you&#8217;ll either need to enable the <code>createCRD</code> flag in this chart, or <a href="#">install-openshift.html.adoc#install-the-custom-resource-definition</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To install the cluster chart run the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">helm repo add couchbase https://couchbase-partners.github.io/helm-charts/
helm install couchbase/couchbase-cluster</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following outlines all of the values exposed by this chart to assist with customizing your deployment.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cluster-configuration"><a class="anchor" href="#cluster-configuration"></a>Cluster Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The helm chart supports creating and managing a single couchbase cluster by exposing the following default values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">createCRD: false
couchbaseCluster:
  create: true
  name: ""
  username: "Administrator"
  password: "password"
  authSecretOverride: ""
  baseImage: "couchbase/server"
  version: "enterprise-6.0.1"
  exposeAdminConsole: true
  adminConsoleServices:
    - data
  exposedFeatures:
    - xdcr
  adminConsoleServiceType: NodePort
  exposedFeatureServiceType: NodePort
  dns:
    domain:
  platform:
  cluster:
    dataServiceMemoryQuota: 256
    indexServiceMemoryQuota: 256
    searchServiceMemoryQuota: 256
    eventingServiceMemoryQuota: 256
    analyticsServiceMemoryQuota: 1024
    indexStorageSetting: memory_optimized
    autoFailoverTimeout: 120
    autoFailoverMaxCount: 3
    autoFailoverOnDataDiskIssues: true
    autoFailoverOnDataDiskIssuesTimePeriod: 120
    autoFailoverServerGroup: false
    logRetentionTime: 604800s
    logRetentionCount: 20
  buckets:
    default:
      name: default
      type: couchbase
      memoryQuota: 128
      replicas: 1
      ioPriority: high
      evictionPolicy: fullEviction
      conflictResolution: seqno
      enableFlush: true
      enableIndexReplica: false
  servers:
    all_services:
      size: 3
      services:
        - data
        - index
        - query
        - search
        - eventing
        - analytics
      serverGroups: []
      pod: {}
  securityContext: {}
  volumeClaimTemplates: []</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="createcrd"><a class="anchor" href="#createcrd"></a>createCRD</h3>
<div class="paragraph">
<p>Option to create the CRD defining the CouchbaseCluster type.</p>
</div>
<div class="paragraph">
<p><em>Value rules:</em> The <code>createCRD</code> value defaults to <code>false</code> which excludes installation of the CRD resource.
Therefore, when <code>false</code>, the CRD should be installed using the Operator chart, or be installed manually.
When set to <code>true</code> the resource is installed.</p>
</div>
</div>
<div class="sect2">
<h3 id="name"><a class="anchor" href="#name"></a>name</h3>
<div class="paragraph">
<p>The name of the cluster to create.</p>
</div>
<div class="paragraph">
<p><em>Value rules:</em> The <code>couchbaseCluster.name</code> value defaults to the name of the chart if not specified.
Must be unique from any other clusters in the namespace.</p>
</div>
</div>
<div class="sect2">
<h3 id="username"><a class="anchor" href="#username"></a>username</h3>
<div class="paragraph">
<p>The username to use as the cluster admin.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This should only be used for experimental and test clusters.
Consider using <code>authSecretOverride</code> to provide a secret containing your own username and password.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Value rules:</em> The <code>couchbaseCluster.username</code> value is a string set to <code>Administrator</code> by default.</p>
</div>
</div>
<div class="sect2">
<h3 id="password"><a class="anchor" href="#password"></a>password</h3>
<div class="paragraph">
<p>The password to use as the cluster admin.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This should only be used for experimental and test clusters.
Consider using <code>authSecretOverride</code> to provide a secret containing your own username and password.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Value rules:</em> The <code>couchbaseCluster.password</code> value is a string set to <code>Administrator</code> by default.</p>
</div>
</div>
<div class="sect2">
<h3 id="authsecretoverride"><a class="anchor" href="#authsecretoverride"></a>authSecretOverride</h3>
<div class="paragraph">
<p>The secret to use for overriding the auto-generated secret.
When specified the username and password from the secret are used for Administrator login.</p>
</div>
<div class="paragraph">
<p><em>Value rules:</em> The <code>couchbaseCluster.authSecretOverride</code> value is the name of a kubernetes secret and is not set by default.
Refer to the couchbase operator documentation for more information about <a href="https://docs.couchbase.com/operator/1.1/deploying-couchbase.html#about-auth-secret"> creating auth secrets </a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="additional-values"><a class="anchor" href="#additional-values"></a>additional values</h3>
<div class="paragraph">
<p>All of the remaining values which can be overridden in this spec are desccribed here in the <a href="couchbase-cluster-config.html" class="page">Couchbase Cluster Config</a> documentation.</p>
</div>
</div>
<div class="sect2">
<h3 id="persistent-volumes"><a class="anchor" href="#persistent-volumes"></a>Persistent Volumes</h3>
<div class="paragraph">
<p>The best way to create a cluster with persistent volumes is to make a custom value file.
The following example shows how volumeMounts can be added to created a persisted cluster.</p>
</div>
<div class="paragraph">
<p>Create a file named <code>values-persistent.yaml</code> with the following values:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">couchbaseCluster:
  servers:
    all_services:
      pod:
        volumeMounts:
          default: couchbase
          data:  couchbase
  securityContext:
      fsGroup: 1000
  volumeClaimTemplates:
    - metadata:
        name: couchbase
      spec:
        storageClassName: "default"
        resources:
          requests:
            storage: 1Gi</code></pre>
</div>
</div>
<div class="paragraph">
<p>Install the cluster chart using the custom value file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">helm install -f values-persistent.yaml couchbase/couchbase-cluster</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="couchbase-tls"><a class="anchor" href="#couchbase-tls"></a>Couchbase TLS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Certificates can be auto-generated or overridden by user supplied certs.
Also since couchbase certs are represented as plain kubernetes secrets, the secret itself can be overridden.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">couchbaseTLS:
  create: false
  expiration: 365
  operatorSecret:
    name:
    cacert:
    cakey:
  clusterSecret:
    name:
    cert:
    key:</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="create"><a class="anchor" href="#create"></a>create</h3>
<div class="paragraph">
<p>This value determines whether the chart should create the cluster with TLS.</p>
</div>
<div class="paragraph">
<p><em>Value rules:</em> The <code>couchbaseTLS.create</code> is a boolean which defaults to <code>false</code>.
When set to <code>true</code> all of the certs and keys required for tls will be auto-generated unless manually specified.
When value is <code>false</code> certs are not generated, but manual Secrets can be provided by overriding both <code>operatorSecret.name</code> and <code>clusterSecret.name</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="expiration"><a class="anchor" href="#expiration"></a>expiration</h3>
<div class="paragraph">
<p>Expiration of CA in days</p>
</div>
<div class="paragraph">
<p><em>Value rules:</em> The <code>couchbaseTLS.expiration</code> defaults to 365 days.</p>
</div>
</div>
<div class="sect2">
<h3 id="operatorsecret-name"><a class="anchor" href="#operatorsecret-name"></a>operatorSecret.name</h3>
<div class="paragraph">
<p>Name of secret with top-level CA of cluster nodes.</p>
</div>
<div class="paragraph">
<p><em>Value rules:</em> The <code>couchbaseTLS.operatorSecret.name</code> value is auto-generated along with its data when <code>couchbaseTLS.create</code> is <code>true</code>.
When overriding, this value must refer to a native kubernetes Secret which contains a Base64 encoded <code>caCert</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="operatorsecret-cert"><a class="anchor" href="#operatorsecret-cert"></a>operatorSecret.cert</h3>
<div class="paragraph">
<p>PEM format CA certificate</p>
</div>
<div class="paragraph">
<p><em>Value rules:</em> The <code>couchbaseTLS.operatorSecret.cert</code> value defaults to an auto-generated CA cert used as the top-level CA.
When overriding, <code>couchbaseTLS.operatorSecret.key</code> must also be provided.</p>
</div>
</div>
<div class="sect2">
<h3 id="operatorsecret-key"><a class="anchor" href="#operatorsecret-key"></a>operatorSecret.key</h3>
<div class="paragraph">
<p>PEM format CA private key</p>
</div>
<div class="paragraph">
<p><em>Value rules:</em> The <code>couchbaseTLS.operatorSecret.key</code> value defaults to an auto-generated CA private key of the CA.
When overriding, <code>couchbaseTLS.operatorSecret.cert</code> must also be provided.</p>
</div>
</div>
<div class="sect2">
<h3 id="clustersecret-name"><a class="anchor" href="#clustersecret-name"></a>clusterSecret.name</h3>
<div class="paragraph">
<p>Name of secret with certs and private key for use by couchbase members.</p>
</div>
<div class="paragraph">
<p><em>Value rules:</em> The <code>couchbaseTLS.operatorSecret.name</code> value is auto-generated along with its data when <code>couchbaseTLS.create</code> is <code>true</code>.
When overriding, this value must refer to a native kubernetes Secret which contains a Base64 encoded <code>cert</code> and <code>key</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="clustersecret-cert"><a class="anchor" href="#clustersecret-cert"></a>clusterSecret.cert</h3>
<div class="paragraph">
<p>PEM format certificate for cluster nodes</p>
</div>
<div class="paragraph">
<p><em>Value rules:</em> The <code>couchbaseTLS.clusterSecret.cert</code> value defaults to an auto-generated client cert.
When overriding, you must also provide the <code>couchbaseTLS.operatorSecret.cert</code> and <code>couchbaseTLS.operatorSecret.key</code> used to generates this client cert.</p>
</div>
</div>
<div class="sect2">
<h3 id="clustersecret-key"><a class="anchor" href="#clustersecret-key"></a>clusterSecret.key</h3>
<div class="paragraph">
<p>PEM format private key for operator</p>
</div>
<div class="paragraph">
<p><em>Value rules:</em> The <code>couchbaseTLS.clusterSecret.key</code> value defaults to an auto-generated private key.
When overriding, you must also provide the <code>couchbaseTLS.operatorSecret.cert</code> and <code>couchbaseTLS.operatorSecret.key</code> used to generate this private key.</p>
</div>
</div>
<div class="sect2">
<h3 id="custom-tls"><a class="anchor" href="#custom-tls"></a>Custom TLS</h3>
<div class="paragraph">
<p>Create cluster with auto-generated tls certs</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">	helm install --set couchbaseTLS.create=true \
               helm/couchbase-cluster</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use manually created secrets</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">helm install  --set couchbaseTLS.create=false \
              --set couchbaseTLS.clusterSecret.name= ”my-secret” \
              helm/couchbase-cluster</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a value file named <code>values-tls.yaml</code> referencing manually created certs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">couchbaseTLS:
  clusterSecret:
    cert: /home/ubuntu/easy-rsa/easyrsa3/pki/ca.crt
    key: /home/ubuntu/easy-rsa/easyrsa3/pki/ca.key
  operatorSecret:
    tlsCert: /home/ubuntu/easy-rsa/easyrsa3/pki/issued/couchbase-operator.crt
    tlsKey: /home/ubuntu/easy-rsa/easyrsa3/pki/private/couchbase-operator.key</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">helm install  -f values-tls.yaml couchbase/couchbase-cluster</code></pre>
</div>
</div>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../_/img/logo.svg" alt="Couchbase">
          </a>
        </div>
        <div class="contact">
          <p class="address">3250 Olcott Street
Santa Clara, CA 95054
United States</p>
          <a href="https://www.couchbase.com/contact" class="btn white-btn">Contact Us</a>
          <a class="tel" href="tel:1-650-417-7500">1-650-417-7500</a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><span class="heading">Company</span></li>
          <li><a href="https://www.couchbase.com/about">About</a></li>
          <li><a href="https://www.couchbase.com/leadership">Leadership</a></li>
          <li><a href="https://www.couchbase.com/news-and-press-releases">News &amp; Press</a></li>
          <li><a href="https://www.couchbase.com/careers">Careers</a></li>
          <li><a href="https://www.couchbase.com/resources/events">Events</a></li>
          <li><a href="https://www.couchbase.com/contact">Contact Us</a></li>
          <li><a href="https://www.couchbase.com/request-pricing">Pricing</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><span class="heading">Support</span></li>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://www.couchbase.com/services">Professional Services</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support Login</a></li>
          <li><a href="https://learn.couchbase.com/store" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><span class="heading">Quicklinks</span></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Online Training</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
          <li><a href="https://www.couchbase.com/nosql-resources/why-nosql">Why NoSQL</a></li>
          <li><a href="https://www.couchbase.com/resources/security">Security</a></li>
          <li><a href="https://www.couchbase.com/resources/gdpr">GDPR</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <a href="https://www.facebook.com/Couchbase" class="icon">
              <svg width="50px" height="50px" viewBox="26.363 116.363 560.215 560.215"><path d="m586.58 209.58c0-48.96-44.252-93.212-93.212-93.212h-373.79c-48.96 0-93.212 44.252-93.212 93.212v373.79c0 48.96 44.252 93.212 93.212 93.212h186.42v-211.85h-68.732v-93.212h68.732v-36.72c0-63.083 47.077-119.58 105.45-119.58h75.323v93.212h-75.323c-8.474 0-17.889 10.357-17.889 25.422v37.662h93.212v93.212h-93.212v211.85h99.803c48.96 0 93.212-44.252 93.212-93.212v-373.79z"/></svg>
            </a>
          </li>
          <li>
            <a href="https://twitter.com/couchbase" class="icon">
              <svg width="50px" height="50px" viewBox="32.012 176.622 542.326 437.815"><path d="m574.34 227.46c-19.772 8.474-41.428 15.065-64.025 17.889 22.597-14.123 40.486-35.778 48.96-61.2-21.655 13.182-45.194 21.655-70.615 27.305-20.714-21.655-48.96-34.837-80.972-34.837-61.2 0-111.1 49.902-111.1 111.1 0 8.474 0.942 16.948 2.825 25.422-92.271-5.649-174.18-49.902-229.74-117.69-9.415 16.006-15.065 35.778-15.065 55.551 0 38.603 19.772 72.498 49.902 92.271-17.889-0.942-35.778-5.649-50.843-14.123v0.942c0 53.668 38.603 98.862 89.446 109.22-9.415 2.825-18.831 3.766-29.188 3.766-7.532 0-14.123-0.942-20.714-1.883 14.123 44.252 55.551 76.265 103.57 77.206-37.662 30.129-85.68 48.018-138.41 48.018-9.415 0-17.889-0.941-26.363-1.883 48.96 32.012 107.34 49.902 170.42 49.902 204.31 0 316.36-169.48 316.36-316.36v-14.123c21.656-14.125 40.487-33.897 55.551-56.494z"/></svg>
            </a>
          </li>
          <li>
            <a href="https://www.linkedin.com/company/couchbase" class="icon">
              <svg width="50px" height="50px" viewBox="31.071 119.188 539.537 540.443"><path d="m531.97 119.19h-461.35c-21.655 0-39.545 16.948-39.545 38.603v463.24c0 21.655 17.889 38.603 39.545 38.603h460.41c21.655 0 39.545-16.948 39.545-38.603v-463.24c0.942-21.656-16.947-38.603-38.603-38.603zm-337.07 451.94h-81.914v-243.86h81.914v243.86zm-40.486-276.81c-28.246 0-46.135-18.831-46.135-42.369s17.889-42.369 46.135-42.369 45.194 17.889 45.194 42.369c0.942 23.538-16.948 42.369-45.194 42.369zm335.19 276.81h-81.914v-129.93c0-32.954-12.24-55.551-41.428-55.551-22.597 0-35.778 15.065-41.428 30.129-1.883 5.649-2.825 12.24-2.825 19.772v136.52h-81.914s0.942-221.26 0-243.86h81.914v34.837c11.298-16.948 30.129-40.486 73.44-40.486 53.668 0 94.154 34.837 94.154 110.16l1e-3 138.41zm-168.54-208.08s0.941-0.941 0 0z"/></svg>
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <span>2019 COUCHBASE All rights reserved.</span>
      <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
      <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
      <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
      <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
    </div>
  </div>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
